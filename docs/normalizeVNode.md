# normalizeVNode 함수 정리

## 1. normalizeVNode란?

normalizeVNode 함수는 가상 DOM(Virtual DOM, VDom) 시스템에서 다양한 입력값을 일관된 형태로 정규화(normalize)하는 역할을 합니다. 이 과정을 통해 렌더링 엔진이 예측 가능하고 안전하게 동작할 수 있습니다.

---

## 2. 왜 필요한가?

- JSX/컴포넌트에서 조건부 렌더링, map, 다양한 타입의 children(문자, 숫자, null, undefined, true, false, 객체 등)이 섞여 들어올 수 있습니다.
- 이런 값들이 그대로 있으면 렌더링 로직이 복잡해지고, 예기치 않은 버그가 발생할 수 있습니다.
- normalizeVNode는 이런 다양한 입력을 **일관된 형태(문자열, vNode 객체, 혹은 빈 문자열)**로 정규화하여, 렌더링 엔진이 예측 가능하게 동작하도록 도와줍니다.

---

## 3. 주요 동작 원리 및 코드별 설명

### 1) null, undefined, true, false → 빈 문자열로 변환

- 화면에 아무것도 그리지 않아야 하므로, 빈 문자열로 변환합니다.
- 특히 true/false는 조건부 렌더링에서 자주 등장합니다.

### 2) 문자열, 숫자 → 문자열로 변환

- 텍스트 노드로 렌더링되어야 하므로, 숫자도 문자열로 변환합니다.
- 예: `<div>{123}</div>` → `<div>123</div>`

### 3) 함수형 컴포넌트 처리

- 함수형 컴포넌트는 실행 결과가 또 다른 vNode이므로,
  props를 넘겨 실행하고, 그 결과를 다시 normalizeVNode로 정규화합니다.
- 재귀적으로 처리하여, 중첩된 컴포넌트도 모두 정규화됩니다.

### 4) vNode 객체의 children 정규화

- vNode의 children이 배열이면, 각 자식을 재귀적으로 normalizeVNode로 정규화합니다.
- 정규화 후에도 Falsy 값(빈 문자열, null, undefined, false, true)은 제거합니다.
- children이 단일 값이면 배열로 변환하여 일관성 유지.
- 어떤 형태의 children이 들어와도 항상 **정규화된 배열**로 처리됩니다.

### 5) 그 외 값은 빈 문자열 반환

- 예외 상황(예상치 못한 타입)이 들어와도, 안전하게 빈 문자열로 처리하여 렌더링 오류를 방지합니다.

---

## 4. 결론

normalizeVNode는 다양한 입력을 **일관된 가상 DOM 구조**로 정규화하여, 렌더링 엔진이 예측 가능하고 안전하게 동작하도록 만듭니다. 이 과정이 없으면, 조건부 렌더링, 컴포넌트, 텍스트, 숫자 등 다양한 케이스에서 예기치 않은 UI 버그가 발생할 수 있습니다.
